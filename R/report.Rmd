---
output: pdf_document
geometry: "left=3cm,right=3cm,top=2cm,bottom=2cm"
header-includes:
  - \usepackage{color}
  - \usepackage[dvipsnames]{xcolor}
  - \usepackage{booktabs}
  - \usepackage{sectsty} \allsectionsfont{\centering}
  - \usepackage{paralist} \let\itemize\compactitem
  - \usepackage[labelformat=empty]{caption}
params:
  country: "Australia"
  version: vers
  data_price: price
  data_price_income: price_income
  rprice: radf_price
  rincome: radf_income
  cv: mc_con
title: "`r params$country ``r params$version`"
fontsize: 12pt 
---

<!-- \pagenumbering{gobble} -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(exuber)
library(knitr)
library(xtable)
```

This page provides figures for real house prices and house-price-to-disposable-income ratios (housing affordability) starting in 1975, exuberance statistics, as well as date-stamping of the specific periods of exuberance.

```{r plot price, fig.width=7, fig.height=3, fig.align='center'}
plot_var(params$data_price, params$country) +
  ggtitle("Real House Prices")

```

```{r plot income, fig.width=7, fig.height=3, fig.align='center'}
plot_var(params$data_price_income, params$country) +
  ggtitle("House-Price-to-Income Ratio")
shiny::setProgress(0.4)
```

## \textcolor{MidnightBlue}{Exuberance Statistics}

```{r summary, results='asis'}

t1 <- kable(summary(params$rprice, params$cv)[[params$country]] %>% 
              round(2), format = "latex", booktabs = TRUE)
t2 <- kable(summary(params$rprice, params$cv)[[params$country]] %>% 
              round(2), format = "latex", booktabs = TRUE)

cat(c("\\begin{table}[!htpb]
    \\begin{minipage}[t]{.5\\linewidth}
      \\caption{Real House Prices}
      \\centering",
        t1,
    "\\end{minipage}%
    \\begin{minipage}[t]{.5\\linewidth}
      \\centering
        \\caption{House-Price-to-Income Ratio}",
        t2,
    "\\end{minipage} 
\\end{table}"
))  
shiny::setProgress(0.6)
```

## \textcolor{MidnightBlue}{Date-Stamping Periods of Exuberance}

<!-- \hspace{3cm} Real House Prices \hspace{4cm}  House-Price-to-Income Ratio -->


```{r autoplot price, fig.width=7, fig.height=3, fig.align='center'}

dg_price <- diagnostics(params$rprice, params$cv)$accepted %in% params$country
if (any(dg_price)) {
  autoplot_var(radf_var = params$rprice, cv_var = params$cv,
               input = params$country, custom_labels = FALSE) +
  ggtitle("Real House Prices")
}else{
  NULL_plot(.size = 3)
}
```

```{r autoplot income, fig.width=7, fig.height=3, fig.align='center'}
dg_income <- diagnostics(params$rincome, params$cv)$accepted %in% params$country
if (any(dg_income)) {
        autoplot_var(radf_var = params$rincome, cv_var = params$cv,
                     input = params$country, custom_labels = FALSE)  +
  ggtitle("House-Price-to-Income Ratio")
}else{
  NULL_plot(.size = 3)
}
shiny::setProgress(0.8) 

```

## \textcolor{MidnightBlue}{Date-Stamping Periods of Exuberance Table}


```{r datestamp, results='asis'}

null_df <- data.frame("Start" = "","End" = "", "Duration" = "")

t1 <- kable(datestamp(params$rprice, params$cv)[[params$country]] %||% 
           null_df,format = "latex", booktabs = TRUE)
          
t2 <- kable(datestamp(params$rincome, params$cv)[[params$country]] %||% 
           null_df,format = "latex", booktabs = TRUE)

cat(c("\\begin{table}[!htpb]
    \\begin{minipage}[t]{.5\\linewidth}
      \\caption{Real House Prices}
      \\centering",
        t1,
    "\\end{minipage}%
    \\begin{minipage}[t]{.5\\linewidth}
      \\centering
        \\caption{House-Price-to-Income Ratio}",
        t2,
    "\\end{minipage}
\\end{table}"
))
shiny::setProgress(0.9) 

```
\vfill

\center{\textit{ Â© 2019 International Housing Observatory. All rights reserverd.}}
